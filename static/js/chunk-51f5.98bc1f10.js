(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-51f5","chunk-238a"],{"0nud":function(t,e,s){"use strict";s.d(e,"e",function(){return o}),s.d(e,"b",function(){return i}),s.d(e,"f",function(){return n}),s.d(e,"c",function(){return r}),s.d(e,"a",function(){return l}),s.d(e,"d",function(){return c});var a=s("t3Un");function o(t){return Object(a.a)({url:"/official/website/class/mate/list",method:"post",data:t})}function i(t){return Object(a.a)({url:"/official/website/class/mate",method:"post",data:t})}function n(t){return Object(a.a)({url:"/official/website/class/mate",method:"put",data:t})}function r(t){return Object(a.a)({url:"/official/website/class/mate/"+t,method:"delete"})}function l(t){return Object(a.a)({url:"/official/website/class/mate/checkout/"+t,method:"post"})}function c(t){return Object(a.a)({url:"/official/website/class/mate/clazzlist",method:"post",data:t})}},"3p5y":function(t,e,s){"use strict";var a=s("RbFn");s.n(a).a},CwI9:function(t,e,s){"use strict";s.r(e);var a={name:"EditNews",components:{ArticleDetail:s("TAlQ").default}},o=s("KHd+"),i=Object(o.a)(a,function(){var t=this.$createElement;return(this._self._c||t)("article-detail",{attrs:{"is-edit":!0}})},[],!1,null,null,null);i.options.__file="edit.vue";e.default=i.exports},MSNs:function(t,e,s){"use strict";s.d(e,"a",function(){return o});var a=s("t3Un");function o(){return Object(a.a)({url:"/qiniu/upload/token",method:"get"})}},RbFn:function(t,e,s){},TAlQ:function(t,e,s){"use strict";s.r(e);var a=s("P2sY"),o=s.n(a),i=s("glbJ"),n=s("fL+G"),r=s("Grqa"),l=s("uARZ"),c=s("Yfch"),u=s("X4fA"),d=s("0nud"),m=s("wBSR"),p={status:"draft",title:"",content:"",synopsis:"",titlePic:"",releaseTime:"",id:void 0,newsClass:"",tags:"",author:"",readingTimes:0},f={name:"ArticleDetail",components:{Tinymce:i.a,MDinput:r.a,Upload:n.a,Sticky:l.a},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,s,a){""===s?(t.$message({message:e.field+"为必传项",type:"error"}),a(new Error(e.field+"为必传项"))):a()};return{postForm:o()({},p),loading:!1,newsClassOptions:[],myHeaders:{"x-auth-token":Object(u.a)()},editFlag:this.isEdit,fileList:[],picVisible:!1,rules:{image_uri:[{validator:e}],title:[{validator:e}],content:[{validator:e}],source_uri:[{validator:function(e,s,a){s?Object(c.b)(s)?a():(t.$message({message:"外链url填写不正确",type:"error"}),a(new Error("外链url填写不正确"))):a()},trigger:"blur"}]}}},computed:{synopsisLength:function(){return this.postForm.synopsis.length}},created:function(){var t=this;if(Object(d.d)({clazzName:"NEWS"}).then(function(e){2e4===e.data.code&&(t.newsClassOptions=e.data.data)}),this.isEdit){var e=this.$route.params&&this.$route.params.id;this.fetchData(e)}else this.postForm=o()({},p)},methods:{handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t),this.postForm.titlePic=t.response.data,this.picVisible=!0},handleSuccess:function(t,e,s){2e4===t.code&&(this.postForm.titlePic=t.data)},fetchData:function(t){var e=this;Object(m.e)(t).then(function(t){e.postForm=t.data.data,e.fileList.splice(0,e.fileList.length),e.fileList.push({name:t.data.data.id,url:t.data.data.titlePic})}).catch(function(t){console.log(t)})},submitForm:function(){var t=this;console.log(this.postForm),this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),t.$message.error("信息填写有错误"),!1;t.loading=!0,t.postForm.status="1",t.editFlag?Object(m.f)(t.postForm).then(function(e){e.data.code,t.$notify({title:"成功",message:"更新文章成功",type:"success",duration:2e3})}):Object(m.b)(t.postForm).then(function(e){2e4===e.data.code?(t.postForm.id=e.data.data.id,t.editFlag=!0,t.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3})):t.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3})}),t.loading=!1})},draftForm:function(){var t=this;0!==this.postForm.content.length&&0!==this.postForm.title.length?(this.loading=!0,this.postForm.status="0",this.editFlag?Object(m.f)(this.postForm).then(function(e){e.data.code,t.$notify({title:"成功",message:"更新草稿成功",type:"success",duration:2e3})}):Object(m.b)(this.postForm).then(function(e){t.postForm.id=e.data.data.id,t.editFlag=!0,e.data.code,t.$notify({title:"成功",message:"保存草稿成功",type:"success",duration:2e3})}),this.loading=!1):this.$message({message:"请填写必要的标题和内容",type:"warning"})}}},h=(s("3p5y"),s("KHd+")),b=Object(h.a)(f,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"createPost-container"},[s("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[s("sticky",{attrs:{"class-name":"sub-navbar "+t.postForm.status}},[s("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布\n      ")]),t._v(" "),s("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:t.draftForm}},[t._v("草稿")])],1),t._v(" "),s("div",{staticClass:"createPost-main-container"},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[s("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v("\n              标题\n            ")])],1),t._v(" "),s("div",{staticClass:"postInfo-container"},[s("el-row",[s("el-col",{attrs:{span:12,xs:12,sm:24,lg:12}},[s("el-form-item",{staticClass:"productInfo-container-item",attrs:{"label-width":"80px",label:"类别:"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.postForm.newsClass,callback:function(e){t.$set(t.postForm,"newsClass",e)},expression:"postForm.newsClass"}},t._l(t.newsClassOptions,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1),t._v(" "),s("el-col",{attrs:{span:12,xs:12,sm:24,lg:12}},[s("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"80px",label:"发布时间:"}},[s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.postForm.releaseTime,callback:function(e){t.$set(t.postForm,"releaseTime",e)},expression:"postForm.releaseTime"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"productInfo-container"},[s("el-row",[s("el-col",{attrs:{span:12,xs:12,sm:24,lg:12}},[s("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"80px",label:"作者:"}},[s("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入作者"},model:{value:t.postForm.author,callback:function(e){t.$set(t.postForm,"author",e)},expression:"postForm.author"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12,xs:12,sm:24,lg:12}},[s("el-form-item",{staticClass:"productInfo-container-item",attrs:{"label-width":"80px",label:"新闻标签:"}},[s("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入标签,多个标签用逗号隔开"},model:{value:t.postForm.tags,callback:function(e){t.$set(t.postForm,"tags",e)},expression:"postForm.tags"}})],1)],1)],1)],1)],1)],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"80px",label:"摘要:"}},[s("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:t.postForm.synopsis,callback:function(e){t.$set(t.postForm,"synopsis",e)},expression:"postForm.synopsis"}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.synopsisLength,expression:"synopsisLength"}],staticClass:"word-counter"},[t._v(t._s(t.synopsisLength)+"字")])],1),t._v(" "),s("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"80px",label:"图片:"}},[s("el-upload",{attrs:{"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.handleSuccess,headers:t.myHeaders,"file-list":t.fileList,action:"http://localhost:8088/official/website/news/upload","list-type":"picture-card"}},[s("i",{staticClass:"el-icon-plus"})]),t._v(" "),s("el-dialog",{attrs:{visible:t.picVisible},on:{"update:visible":function(e){t.picVisible=e}}},[s("img",{attrs:{src:t.postForm.titlePic,width:"100%",alt:""}})])],1),t._v(" "),s("div",{staticClass:"editor-container"},[s("Tinymce",{ref:"editor",attrs:{height:400},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1)],1)],1)],1)},[],!1,null,"46a0512a",null);b.options.__file="ArticleDetail.vue";e.default=b.exports},wBSR:function(t,e,s){"use strict";s.d(e,"d",function(){return o}),s.d(e,"e",function(){return i}),s.d(e,"b",function(){return n}),s.d(e,"f",function(){return r}),s.d(e,"c",function(){return l}),s.d(e,"a",function(){return c});var a=s("t3Un");function o(t){return Object(a.a)({url:"/official/website/news/list",method:"post",data:t})}function i(t){return Object(a.a)({url:"/official/website/news/"+t,method:"get"})}function n(t){return Object(a.a)({url:"/official/website/news",method:"post",data:t})}function r(t){return Object(a.a)({url:"/official/website/news",method:"put",data:t})}function l(t){return Object(a.a)({url:"/official/website/news/"+t,method:"delete"})}function c(t){return Object(a.a)({url:"/official/website/news/checkout/"+t,method:"post"})}}}]);