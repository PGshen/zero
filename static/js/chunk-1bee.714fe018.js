(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1bee"],{"XDt+":function(e,t,s){"use strict";s.r(t);var i=s("P2sY"),a=s.n(i),l=s("QbLZ"),r=s.n(l),o=s("7Qib"),n=s("Yfch"),c=s("iWu5"),u=s("L2JU"),d={name:"UserManager",directives:{waves:s("ZySA").a},components:{ImageCropper:c.a},filters:{statusFilter:function(e){return{published:"success",draft:"gray",deleted:"danger"}[e]}},data:function(){var e=this;return{list:null,total:null,listLoading:!0,listQuery:{page:1,size:10,order:"id",cond:{}},user:{id:void 0,name:"",loginName:"",idCard:"",phone:"",password:"",qq:"",email:"",role:[]},roleOption:null,authRoles:[],sortOptions:[{label:"按ID升序列",key:"+id"},{label:"按ID降序",key:"-id"}],dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑用户",create:"创建用户"},loginRules:{loginName:[{required:!0,trigger:"blur",validator:function(e,t,s){Object(n.a)(t)?s():s(new Error("请输入正确的合法手机号码"))}}],password:[{required:!0,trigger:"blur",validator:function(e,t,s){void 0!==t&&t.length<6?s(new Error("密码不能小于6位")):s()}}],comfirm:[{required:!1,trigger:"blur",validator:function(t,s,i){void 0!==s&&e.user.password!==s?i(new Error("两次密码不一致")):i()}}]},tableKey:0,imageCropperShow:!1,imageCropperKey:"test"}},computed:r()({},Object(u.c)(["userList","permList"])),created:function(){this.getList()},methods:r()({},Object(u.b)({GetUserList:"GetUserList",AddUser:"AddUser",UpdateUser:"UpdateUser",DeleteUser:"DeleteUser",RoleListForUserAuth:"RoleListForUserAuth",UserRoleListForAuth:"UserRoleListForAuth"}),{imageCropperClose:function(){this.imageCropperShow=!1},imageCropperSuccess:function(){this.imagecropperShow=!1},getList:function(){var e=this;this.listLoading=!0,this.GetUserList(this.listQuery).then(function(t){t?(e.$notify({title:"成功",message:"获取成功",type:"success",duration:500}),e.listLoading=!1):(e.$notify({title:"失败",message:"获取失败",type:"fail",duration:2e3}),e.listLoading=!1)})},handleFilter:function(){this.getList()},handleSizeChange:function(e){this.listQuery.size=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handleCreate:function(){var e=this;this.resetUser(),this.RoleListForUserAuth().then(function(t){1===t.status&&(e.roleOption=t.data)}),this.dialogStatus="create",this.dialogFormVisible=!0},handleUpdate:function(e){var t=this;this.user=a()({},e),this.RoleListForUserAuth().then(function(e){1===e.status&&(t.roleOption=e.data)}),this.UserRoleListForAuth({userId:e.id}).then(function(e){1===e.status&&(t.user.role=e.data)}),this.dialogStatus="update",this.dialogFormVisible=!0},handleDelete:function(e){var t=this;this.DeleteUser(e.id).then(function(e){e?(t.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),t.getList()):t.$notify({title:"失败",message:"删除失败",type:"fail",duration:2e3})}).catch(function(e){t.$message.error(e)})},create:function(){var e=this;this.AddUser(this.user).then(function(t){t?(e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.getList()):e.$notify({title:"失败",message:"创建失败",type:"fail",duration:2e3})}).catch(function(t){e.$message.error(t)})},update:function(){var e=this;this.UpdateUser(this.user).then(function(t){t?(e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3}),e.getList()):e.$notify({title:"失败",message:"更新失败",type:"fail",duration:2e3})}).catch(function(t){e.$message.error(t)})},resetUser:function(){this.user={id:void 0,name:"",loginName:"",idCard:"",phone:"",qq:"",email:"",role:[]}},handleDownload:function(){var e=this;Promise.all([s.e("chunk-7a57"),s.e("chunk-3e35"),s.e("chunk-50e4")]).then(function(){(0,s("S/jZ").export_json_to_excel)(["时间","地区","类型","标题","重要性"],e.formatJson(["timestamp","province","type","title","importance"],e.list),"table数据")}.bind(null,s)).catch(s.oe)},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?Object(o.d)(t[e]):t[e]})})}})},p=(s("pOgZ"),s("KHd+")),m=Object(p.a)(d,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container calendar-list-container"},[s("div",{staticClass:"filter-container"},[s("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"名称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleFilter(t):null}},model:{value:e.listQuery.cond.name,callback:function(t){e.$set(e.listQuery.cond,"name",t)},expression:"listQuery.cond.name"}}),e._v(" "),s("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"排序"},on:{change:e.handleFilter},model:{value:e.listQuery.order,callback:function(t){e.$set(e.listQuery,"order",t)},expression:"listQuery.order"}},e._l(e.sortOptions,function(e){return s("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),e._v(" "),void 0!==e.permList&&-1!==e.permList.indexOf("sys:user:list")?s("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"search"},on:{click:e.handleFilter}},[e._v("搜索")]):e._e(),e._v(" "),void 0!==e.permList&&-1!==e.permList.indexOf("sys:user:add")?s("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"edit"},on:{click:e.handleCreate}},[e._v("\n      添加\n    ")]):e._e(),e._v(" "),s("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"document"},on:{click:e.handleDownload}},[e._v("导出")])],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",fit:""}},[s("el-table-column",{attrs:{align:"center",label:"序号",width:"50",type:"index"}}),e._v(" "),s("el-table-column",{attrs:{width:"80",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"link-type",on:{click:function(s){e.handleUpdate(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"130",label:"登录名"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.loginName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"180",label:"身份证"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.idCard))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"130",label:"电话"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.phone))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"100",label:"QQ"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.qq))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"180",label:"邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.email))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"180px",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.createdTime))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!==e.permList&&-1!==e.permList.indexOf("sys:user:update")?s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){e.handleUpdate(t.row)}}},[e._v("编辑\n        ")]):e._e(),e._v(" "),void 0!==e.permList&&-1!==e.permList.indexOf("sys:user:ban")?s("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(s){e.handleUpdate(t.row)}}},[e._v("禁用\n        ")]):e._e(),e._v(" "),void 0!==e.permList&&-1!==e.permList.indexOf("sys:user:delete")?s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){e.handleDelete(t.row)}}},[e._v("删除\n        ")]):e._e()]}}])})],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[s("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[2,10,20,30,50],"page-size":e.listQuery.size,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:currentPage":function(t){e.$set(e.listQuery,"page",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],"close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-form",{staticClass:"small-space user-form",attrs:{rules:e.loginRules,inline:!0,model:e.user,"label-position":"left","label-width":"70px"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"名称"}},[s("el-input",{staticClass:"filter-item",staticStyle:{display:"flex",flex:"1"},attrs:{placeholder:"请输入真实姓名"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{prop:"loginName",label:"登录名"}},[s("el-input",{staticClass:"filter-item",attrs:{name:"loginName",placeholder:"请输入手机号"},model:{value:e.user.loginName,callback:function(t){e.$set(e.user,"loginName",t)},expression:"user.loginName"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"身份证"}},[s("el-input",{staticClass:"filter-item",staticStyle:{display:"flex",flex:"1"},attrs:{placeholder:"请输入身份证"},model:{value:e.user.idCard,callback:function(t){e.$set(e.user,"idCard",t)},expression:"user.idCard"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"电话"}},[s("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入联系电话"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"QQ"}},[s("el-input",{staticClass:"filter-item",staticStyle:{display:"flex",flex:"1"},attrs:{placeholder:"请输入QQ"},model:{value:e.user.qq,callback:function(t){e.$set(e.user,"qq",t)},expression:"user.qq"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"邮箱"}},[s("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入Email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{prop:"password",label:"密码"}},[s("el-input",{staticClass:"filter-item",staticStyle:{display:"flex",flex:"1"},attrs:{name:"password",placeholder:"请输入密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{prop:"comfirm",label:"确认密码"}},[s("el-input",{staticClass:"filter-item",attrs:{name:"comfirm",placeholder:"请再次输入密码"},model:{value:e.user.comfirm,callback:function(t){e.$set(e.user,"comfirm",t)},expression:"user.comfirm"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{staticClass:"user-form-item",attrs:{label:"头像"}},[s("el-button",{attrs:{type:"primary",icon:"upload"},on:{click:function(t){e.imageCropperShow=!0}}},[e._v("修改头像")])],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:3}},[e._v("\n          角色分配\n        ")]),e._v(" "),s("el-col",{attrs:{span:24}},[s("el-select",{staticStyle:{width:"100%","padding-right":"20px","margin-top":"10px"},attrs:{multiple:"",filterable:"","allow-create":"",placeholder:"请选择角色"},model:{value:e.user.role,callback:function(t){e.$set(e.user,"role",t)},expression:"user.role"}},e._l(e.roleOption,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"===e.dialogStatus?s("el-button",{attrs:{type:"primary"},on:{click:e.create}},[e._v("确 定")]):s("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确 定")])],1),e._v(" "),s("ImageCropper",{directives:[{name:"show",rawName:"v-show",value:e.imageCropperShow,expression:"imageCropperShow"}],key:e.imageCropperKey,attrs:{width:300,height:300,url:"http://localhost/upload"},on:{close:e.imageCropperClose,"crop-upload-success":e.imageCropperSuccess}})],1)],1)},[],!1,null,null,null);m.options.__file="users.vue";t.default=m.exports},ZySA:function(e,t,s){"use strict";var i=s("P2sY"),a=s.n(i),l=(s("jUE0"),{bind:function(e,t){e.addEventListener("click",function(s){var i=a()({},t.value),l=a()({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),r=l.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var o=r.getBoundingClientRect(),n=r.querySelector(".waves-ripple");switch(n?n.className="waves-ripple":((n=document.createElement("span")).className="waves-ripple",n.style.height=n.style.width=Math.max(o.width,o.height)+"px",r.appendChild(n)),l.type){case"center":n.style.top=o.height/2-n.offsetHeight/2+"px",n.style.left=o.width/2-n.offsetWidth/2+"px";break;default:n.style.top=(s.pageY-o.top-n.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",n.style.left=(s.pageX-o.left-n.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return n.style.backgroundColor=l.color,n.className="waves-ripple z-active",!1}},!1)}}),r=function(e){e.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(r)),l.install=r;t.a=l},ikZi:function(e,t,s){},jUE0:function(e,t,s){},pOgZ:function(e,t,s){"use strict";var i=s("ikZi");s.n(i).a}}]);